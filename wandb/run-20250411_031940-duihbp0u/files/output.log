Training started...
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:50,965][__main__][INFO] - Train Epoch: 0 [0/7 (0%)]	Loss: 1.201239
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:51,153][__main__][INFO] - Epoch 0: Val Loss: 14.2533, Accuracy: 0.5842, Metrics: {'accuracy': 0.5841584158415841, 'f1_macro': 0.184375, 'f1_weighted': 0.43081683168316837, 'precision_macro': 0.14603960396039603, 'recall_macro': 0.25}
[2025-04-11 03:19:51,390][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:51,966][__main__][INFO] - Train Epoch: 1 [0/7 (0%)]	Loss: 11.418483
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:52,254][__main__][INFO] - Epoch 1: Val Loss: 5.8080, Accuracy: 0.1782, Metrics: {'accuracy': 0.1782178217821782, 'f1_macro': 0.21354635463546354, 'f1_weighted': 0.09303009508871679, 'precision_macro': 0.18964646464646465, 'recall_macro': 0.40909090909090906}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:52,299][__main__][INFO] - Train Epoch: 2 [0/7 (0%)]	Loss: 4.859587
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:52,586][__main__][INFO] - Epoch 2: Val Loss: 2.6597, Accuracy: 0.5644, Metrics: {'accuracy': 0.5643564356435643, 'f1_macro': 0.2881899871630295, 'f1_weighted': 0.5108097459296636, 'precision_macro': 0.2568623310810811, 'recall_macro': 0.3406779661016949}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:52,630][__main__][INFO] - Train Epoch: 3 [0/7 (0%)]	Loss: 1.982829
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:52,915][__main__][INFO] - Epoch 3: Val Loss: 2.6002, Accuracy: 0.1485, Metrics: {'accuracy': 0.1485148514851485, 'f1_macro': 0.1598090849242923, 'f1_weighted': 0.08111772335890599, 'precision_macro': 0.24373040752351097, 'recall_macro': 0.3204545454545455}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:52,958][__main__][INFO] - Train Epoch: 4 [0/7 (0%)]	Loss: 2.397926
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:53,243][__main__][INFO] - Epoch 4: Val Loss: 2.2076, Accuracy: 0.5842, Metrics: {'accuracy': 0.5841584158415841, 'f1_macro': 0.3010269576379974, 'f1_weighted': 0.5272563199837313, 'precision_macro': 0.26752533783783783, 'recall_macro': 0.35741525423728815}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:53,285][__main__][INFO] - Train Epoch: 5 [0/7 (0%)]	Loss: 1.844719
[2025-04-11 03:19:53,572][__main__][INFO] - Epoch 5: Val Loss: 1.3802, Accuracy: 0.6634, Metrics: {'accuracy': 0.6633663366336634, 'f1_macro': 0.4192597757065524, 'f1_weighted': 0.5764567691920848, 'precision_macro': 0.5522151898734178, 'recall_macro': 0.4770608628659476}
[2025-04-11 03:19:53,736][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-11 03:19:53,785][__main__][INFO] - Train Epoch: 6 [0/7 (0%)]	Loss: 0.664955
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:53,950][__main__][INFO] - Epoch 6: Val Loss: 1.2319, Accuracy: 0.6535, Metrics: {'accuracy': 0.6534653465346535, 'f1_macro': 0.39852318969466677, 'f1_weighted': 0.5954207353793831, 'precision_macro': 0.39319717444717445, 'recall_macro': 0.43191448382126346}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:53,975][__main__][INFO] - Train Epoch: 7 [0/7 (0%)]	Loss: 0.670790
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:54,134][__main__][INFO] - Epoch 7: Val Loss: 1.5064, Accuracy: 0.6436, Metrics: {'accuracy': 0.6435643564356436, 'f1_macro': 0.3277972027972028, 'f1_weighted': 0.558021186734058, 'precision_macro': 0.5163690476190477, 'recall_macro': 0.3434899845916795}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:54,160][__main__][INFO] - Train Epoch: 8 [0/7 (0%)]	Loss: 0.811354
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:54,317][__main__][INFO] - Epoch 8: Val Loss: 0.9897, Accuracy: 0.7327, Metrics: {'accuracy': 0.7326732673267327, 'f1_macro': 0.5402665823718455, 'f1_weighted': 0.6826267643359879, 'precision_macro': 0.5647252321981424, 'recall_macro': 0.5338790446841294}
[2025-04-11 03:19:54,413][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:54,463][__main__][INFO] - Train Epoch: 9 [0/7 (0%)]	Loss: 0.618150
[2025-04-11 03:19:54,631][__main__][INFO] - Epoch 9: Val Loss: 0.9415, Accuracy: 0.7228, Metrics: {'accuracy': 0.7227722772277227, 'f1_macro': 0.5894344069128044, 'f1_weighted': 0.6927393109639771, 'precision_macro': 0.71875, 'recall_macro': 0.5500963020030817}
[2025-04-11 03:19:54,656][__main__][INFO] - Train Epoch: 10 [0/7 (0%)]	Loss: 0.611275
[2025-04-11 03:19:54,817][__main__][INFO] - Epoch 10: Val Loss: 0.7939, Accuracy: 0.7525, Metrics: {'accuracy': 0.7524752475247525, 'f1_macro': 0.7074478015229673, 'f1_weighted': 0.7542430764815611, 'precision_macro': 0.706366020984665, 'recall_macro': 0.7170261941448383}
[2025-04-11 03:19:54,905][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-11 03:19:54,958][__main__][INFO] - Train Epoch: 11 [0/7 (0%)]	Loss: 0.509224
[2025-04-11 03:19:55,123][__main__][INFO] - Epoch 11: Val Loss: 1.1079, Accuracy: 0.4554, Metrics: {'accuracy': 0.45544554455445546, 'f1_macro': 0.5257805658725125, 'f1_weighted': 0.48001194086253446, 'precision_macro': 0.5896683673469387, 'recall_macro': 0.6083975346687212}
[2025-04-11 03:19:55,149][__main__][INFO] - Train Epoch: 12 [0/7 (0%)]	Loss: 1.157101
[2025-04-11 03:19:55,307][__main__][INFO] - Epoch 12: Val Loss: 0.7617, Accuracy: 0.7327, Metrics: {'accuracy': 0.7326732673267327, 'f1_macro': 0.666773668892313, 'f1_weighted': 0.7297729772977297, 'precision_macro': 0.6862090945777387, 'recall_macro': 0.6613443759630201}
[2025-04-11 03:19:55,332][__main__][INFO] - Train Epoch: 13 [0/7 (0%)]	Loss: 0.518040
[2025-04-11 03:19:55,498][__main__][INFO] - Epoch 13: Val Loss: 0.8666, Accuracy: 0.7525, Metrics: {'accuracy': 0.7524752475247525, 'f1_macro': 0.685971685971686, 'f1_weighted': 0.7526791289167527, 'precision_macro': 0.6967732364067949, 'recall_macro': 0.6800462249614792}
[2025-04-11 03:19:55,522][__main__][INFO] - Train Epoch: 14 [0/7 (0%)]	Loss: 0.464392
[2025-04-11 03:19:55,682][__main__][INFO] - Epoch 14: Val Loss: 0.7055, Accuracy: 0.7327, Metrics: {'accuracy': 0.7326732673267327, 'f1_macro': 0.6748819362455726, 'f1_weighted': 0.7298385682724116, 'precision_macro': 0.6841773817580269, 'recall_macro': 0.6735362095531587}
[2025-04-11 03:19:55,711][__main__][INFO] - Train Epoch: 15 [0/7 (0%)]	Loss: 0.479837
[2025-04-11 03:19:55,877][__main__][INFO] - Epoch 15: Val Loss: 0.7080, Accuracy: 0.7921, Metrics: {'accuracy': 0.7920792079207921, 'f1_macro': 0.7215965055965057, 'f1_weighted': 0.7827731097434067, 'precision_macro': 0.7641329258976318, 'recall_macro': 0.6969953775038521}
[2025-04-11 03:19:55,972][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-11 03:19:56,022][__main__][INFO] - Train Epoch: 16 [0/7 (0%)]	Loss: 0.382172
[2025-04-11 03:19:56,186][__main__][INFO] - Epoch 16: Val Loss: 0.7810, Accuracy: 0.7525, Metrics: {'accuracy': 0.7524752475247525, 'f1_macro': 0.7064512064512065, 'f1_weighted': 0.7555079832307554, 'precision_macro': 0.7045792611715533, 'recall_macro': 0.7170261941448383}
[2025-04-11 03:19:56,211][__main__][INFO] - Train Epoch: 17 [0/7 (0%)]	Loss: 0.466792
[2025-04-11 03:19:56,373][__main__][INFO] - Epoch 17: Val Loss: 0.7813, Accuracy: 0.7822, Metrics: {'accuracy': 0.7821782178217822, 'f1_macro': 0.7059696342305037, 'f1_weighted': 0.7709174644172491, 'precision_macro': 0.7508972992181947, 'recall_macro': 0.6844953775038521}
[2025-04-11 03:19:56,399][__main__][INFO] - Train Epoch: 18 [0/7 (0%)]	Loss: 0.338364
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:56,559][__main__][INFO] - Epoch 18: Val Loss: 1.1693, Accuracy: 0.7624, Metrics: {'accuracy': 0.7623762376237624, 'f1_macro': 0.5961173860427592, 'f1_weighted': 0.7147168891959789, 'precision_macro': 0.6131372549019608, 'recall_macro': 0.5918335901386749}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:56,587][__main__][INFO] - Train Epoch: 19 [0/7 (0%)]	Loss: 0.559445
[2025-04-11 03:19:56,747][__main__][INFO] - Epoch 19: Val Loss: 0.7217, Accuracy: 0.7723, Metrics: {'accuracy': 0.7722772277227723, 'f1_macro': 0.7115624890015134, 'f1_weighted': 0.7662783699972785, 'precision_macro': 0.7295454545454546, 'recall_macro': 0.6987480739599383}
[2025-04-11 03:19:56,774][__main__][INFO] - Train Epoch: 20 [0/7 (0%)]	Loss: 0.324115
[2025-04-11 03:19:56,937][__main__][INFO] - Epoch 20: Val Loss: 0.8481, Accuracy: 0.7624, Metrics: {'accuracy': 0.7623762376237624, 'f1_macro': 0.6589410589410589, 'f1_weighted': 0.7401153302143401, 'precision_macro': 0.7523740930431071, 'recall_macro': 0.6307781201848999}
[2025-04-11 03:19:56,964][__main__][INFO] - Train Epoch: 21 [0/7 (0%)]	Loss: 0.460941
[2025-04-11 03:19:57,125][__main__][INFO] - Epoch 21: Val Loss: 0.8766, Accuracy: 0.7525, Metrics: {'accuracy': 0.7524752475247525, 'f1_macro': 0.6057084349069082, 'f1_weighted': 0.7173912341322212, 'precision_macro': 0.6923926767676768, 'recall_macro': 0.5978235747303544}
[2025-04-11 03:19:57,150][__main__][INFO] - Train Epoch: 22 [0/7 (0%)]	Loss: 0.275018
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:57,310][__main__][INFO] - Epoch 22: Val Loss: 0.9021, Accuracy: 0.7624, Metrics: {'accuracy': 0.7623762376237624, 'f1_macro': 0.5869741922373501, 'f1_weighted': 0.713720345820398, 'precision_macro': 0.5906597774244833, 'recall_macro': 0.5918335901386749}
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-11 03:19:57,334][__main__][INFO] - Train Epoch: 23 [0/7 (0%)]	Loss: 0.413348
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-11 03:19:57,500][__main__][INFO] - Epoch 23: Val Loss: 1.1991, Accuracy: 0.7129, Metrics: {'accuracy': 0.7128712871287128, 'f1_macro': 0.5203472310765439, 'f1_weighted': 0.6526367924309963, 'precision_macro': 0.5408515535097814, 'recall_macro': 0.5293335901386749}
                                                                                                                                                                                                   
[2025-04-11 03:19:57,525][__main__][INFO] - Train Epoch: 24 [0/7 (0%)]	Loss: 0.592433
[2025-04-11 03:19:57,686][__main__][INFO] - Epoch 24: Val Loss: 0.8303, Accuracy: 0.7327, Metrics: {'accuracy': 0.7326732673267327, 'f1_macro': 0.6256774609834742, 'f1_weighted': 0.7116906896780204, 'precision_macro': 0.6748626373626374, 'recall_macro': 0.6098035439137134}
[2025-04-11 03:19:57,687][__main__][INFO] - Early stopping triggered after 24 epochs
[2025-04-11 03:19:57,688][__main__][INFO] - Saving best confusion matrix with accuracy: 0.7921
