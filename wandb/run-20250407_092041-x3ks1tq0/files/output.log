Training started...
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-07 09:20:43,532][__main__][INFO] - Train Epoch: 0 [0/51 (0%)]	Loss: 1.312119
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-07 09:20:44,559][__main__][INFO] - Epoch 0: Val Loss: 5.3759, Accuracy: 0.6535, Metrics: {'accuracy': 0.6534653465346535, 'f1_macro': 0.36256749076442174, 'f1_weighted': 0.5851994406601786, 'precision_macro': 0.3730880801687763, 'recall_macro': 0.374479969183359}
[2025-04-07 09:20:44,729][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
/home/khanhnt/.conda/envs/naim/lib/python3.9/site-packages/sklearn/metrics/_classification.py:1497: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.
[2025-04-07 09:20:45,284][__main__][INFO] - Train Epoch: 1 [0/51 (0%)]	Loss: 0.006357
  _warn_prf(average, modifier, f"{metric.capitalize()} is", len(result))
[2025-04-07 09:20:46,881][__main__][INFO] - Epoch 1: Val Loss: 3.8834, Accuracy: 0.2376, Metrics: {'accuracy': 0.2376237623762376, 'f1_macro': 0.20864427860696516, 'f1_weighted': 0.16182700359588195, 'precision_macro': 0.263996138996139, 'recall_macro': 0.4530046224961479}
                                                                                                                                                                                    
[2025-04-07 09:20:46,911][__main__][INFO] - Train Epoch: 2 [0/51 (0%)]	Loss: 4.155045
[2025-04-07 09:20:48,406][__main__][INFO] - Epoch 2: Val Loss: 1.3354, Accuracy: 0.5743, Metrics: {'accuracy': 0.5742574257425742, 'f1_macro': 0.4592265817238008, 'f1_weighted': 0.5522115615343515, 'precision_macro': 0.6116427432216907, 'recall_macro': 0.539637904468413}
[2025-04-07 09:20:48,438][__main__][INFO] - Train Epoch: 3 [0/51 (0%)]	Loss: 0.429149
[2025-04-07 09:20:49,927][__main__][INFO] - Epoch 3: Val Loss: 1.2883, Accuracy: 0.6634, Metrics: {'accuracy': 0.6633663366336634, 'f1_macro': 0.5154207581036849, 'f1_weighted': 0.6193938557618828, 'precision_macro': 0.669625946969697, 'recall_macro': 0.5962634822804315}
[2025-04-07 09:20:50,104][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-07 09:20:50,173][__main__][INFO] - Train Epoch: 4 [0/51 (0%)]	Loss: 1.098260
[2025-04-07 09:20:51,760][__main__][INFO] - Epoch 4: Val Loss: 1.0107, Accuracy: 0.6634, Metrics: {'accuracy': 0.6633663366336634, 'f1_macro': 0.6269584397214131, 'f1_weighted': 0.6741983077366966, 'precision_macro': 0.6607236154649948, 'recall_macro': 0.6356124807395993}
[2025-04-07 09:20:51,792][__main__][INFO] - Train Epoch: 5 [0/51 (0%)]	Loss: 0.524858
[2025-04-07 09:20:53,313][__main__][INFO] - Epoch 5: Val Loss: 0.8855, Accuracy: 0.5545, Metrics: {'accuracy': 0.5544554455445545, 'f1_macro': 0.5926519196542079, 'f1_weighted': 0.5849176679681698, 'precision_macro': 0.6426710544357603, 'recall_macro': 0.6385785824345147}
[2025-04-07 09:20:53,342][__main__][INFO] - Train Epoch: 6 [0/51 (0%)]	Loss: 0.298351
[2025-04-07 09:20:54,893][__main__][INFO] - Epoch 6: Val Loss: 0.8869, Accuracy: 0.6535, Metrics: {'accuracy': 0.6534653465346535, 'f1_macro': 0.6548422734548911, 'f1_weighted': 0.6734769046394443, 'precision_macro': 0.707038332038332, 'recall_macro': 0.6683551617873651}
[2025-04-07 09:20:54,926][__main__][INFO] - Train Epoch: 7 [0/51 (0%)]	Loss: 0.269855
[2025-04-07 09:20:56,475][__main__][INFO] - Epoch 7: Val Loss: 0.9347, Accuracy: 0.6634, Metrics: {'accuracy': 0.6633663366336634, 'f1_macro': 0.493039368039368, 'f1_weighted': 0.6162988093681162, 'precision_macro': 0.5548658675799087, 'recall_macro': 0.5286016949152542}
[2025-04-07 09:20:56,508][__main__][INFO] - Train Epoch: 8 [0/51 (0%)]	Loss: 1.097569
[2025-04-07 09:20:58,103][__main__][INFO] - Epoch 8: Val Loss: 0.7337, Accuracy: 0.6733, Metrics: {'accuracy': 0.6732673267326733, 'f1_macro': 0.6613624532677109, 'f1_weighted': 0.6906468887388478, 'precision_macro': 0.6816979316979317, 'recall_macro': 0.6748651771956856}
[2025-04-07 09:20:58,298][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-07 09:20:58,371][__main__][INFO] - Train Epoch: 9 [0/51 (0%)]	Loss: 0.740378
[2025-04-07 09:20:59,831][__main__][INFO] - Epoch 9: Val Loss: 0.7604, Accuracy: 0.7228, Metrics: {'accuracy': 0.7227722772277227, 'f1_macro': 0.6867311770943796, 'f1_weighted': 0.7280393309744548, 'precision_macro': 0.6826923076923077, 'recall_macro': 0.6921224961479199}
[2025-04-07 09:21:00,019][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-07 09:21:00,089][__main__][INFO] - Train Epoch: 10 [0/51 (0%)]	Loss: 0.204340
[2025-04-07 09:21:01,610][__main__][INFO] - Epoch 10: Val Loss: 0.8673, Accuracy: 0.7228, Metrics: {'accuracy': 0.7227722772277227, 'f1_macro': 0.6207266997708174, 'f1_weighted': 0.7005461050306712, 'precision_macro': 0.678082191780822, 'recall_macro': 0.5953389830508474}
[2025-04-07 09:21:01,641][__main__][INFO] - Train Epoch: 11 [0/51 (0%)]	Loss: 0.881932
[2025-04-07 09:21:03,163][__main__][INFO] - Epoch 11: Val Loss: 0.8475, Accuracy: 0.6733, Metrics: {'accuracy': 0.6732673267326733, 'f1_macro': 0.6003563218390805, 'f1_weighted': 0.6619456014566973, 'precision_macro': 0.6417055167055168, 'recall_macro': 0.6048343605546995}
[2025-04-07 09:21:03,196][__main__][INFO] - Train Epoch: 12 [0/51 (0%)]	Loss: 0.441552
[2025-04-07 09:21:04,778][__main__][INFO] - Epoch 12: Val Loss: 0.8157, Accuracy: 0.6139, Metrics: {'accuracy': 0.6138613861386139, 'f1_macro': 0.6096291866028708, 'f1_weighted': 0.6328177554597565, 'precision_macro': 0.648466566113625, 'recall_macro': 0.6431432973805855}
[2025-04-07 09:21:04,811][__main__][INFO] - Train Epoch: 13 [0/51 (0%)]	Loss: 0.272848
[2025-04-07 09:21:06,329][__main__][INFO] - Epoch 13: Val Loss: 0.7972, Accuracy: 0.4950, Metrics: {'accuracy': 0.49504950495049505, 'f1_macro': 0.6032494288308241, 'f1_weighted': 0.49609419952500766, 'precision_macro': 0.6886566332218507, 'recall_macro': 0.7323574730354392}
[2025-04-07 09:21:06,365][__main__][INFO] - Train Epoch: 14 [0/51 (0%)]	Loss: 0.549673
[2025-04-07 09:21:07,874][__main__][INFO] - Epoch 14: Val Loss: 0.7560, Accuracy: 0.7426, Metrics: {'accuracy': 0.7425742574257426, 'f1_macro': 0.6972814637892526, 'f1_weighted': 0.7437224773395731, 'precision_macro': 0.713923844972232, 'recall_macro': 0.6942989214175656}
[2025-04-07 09:21:08,043][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-07 09:21:08,112][__main__][INFO] - Train Epoch: 15 [0/51 (0%)]	Loss: 0.251888
[2025-04-07 09:21:09,690][__main__][INFO] - Epoch 15: Val Loss: 0.9080, Accuracy: 0.5446, Metrics: {'accuracy': 0.5445544554455446, 'f1_macro': 0.5537897364234802, 'f1_weighted': 0.5778405641339307, 'precision_macro': 0.5900816229763598, 'recall_macro': 0.611517719568567}
[2025-04-07 09:21:09,723][__main__][INFO] - Train Epoch: 16 [0/51 (0%)]	Loss: 0.587854
[2025-04-07 09:21:11,276][__main__][INFO] - Epoch 16: Val Loss: 0.7144, Accuracy: 0.7129, Metrics: {'accuracy': 0.7128712871287128, 'f1_macro': 0.6989200324398535, 'f1_weighted': 0.7270609276857536, 'precision_macro': 0.7079708813199379, 'recall_macro': 0.7287942989214176}
[2025-04-07 09:21:11,304][__main__][INFO] - Train Epoch: 17 [0/51 (0%)]	Loss: 0.576425
[2025-04-07 09:21:12,821][__main__][INFO] - Epoch 17: Val Loss: 1.0953, Accuracy: 0.7822, Metrics: {'accuracy': 0.7821782178217822, 'f1_macro': 0.6640834290088021, 'f1_weighted': 0.74593142437091, 'precision_macro': 0.7732051282051282, 'recall_macro': 0.647515408320493}
[2025-04-07 09:21:12,995][tensorboardX.summary][INFO] - Summary name Validation/Confusion Matrix is illegal; using Validation/Confusion_Matrix instead.
[2025-04-07 09:21:13,059][__main__][INFO] - Train Epoch: 18 [0/51 (0%)]	Loss: 1.114443
[2025-04-07 09:21:14,510][__main__][INFO] - Epoch 18: Val Loss: 0.8179, Accuracy: 0.5050, Metrics: {'accuracy': 0.504950495049505, 'f1_macro': 0.5639764497765503, 'f1_weighted': 0.5449871563673343, 'precision_macro': 0.6187782805429864, 'recall_macro': 0.6130585516178737}
[2025-04-07 09:21:14,543][__main__][INFO] - Train Epoch: 19 [0/51 (0%)]	Loss: 0.461035
[2025-04-07 09:21:16,146][__main__][INFO] - Epoch 19: Val Loss: 0.7242, Accuracy: 0.7228, Metrics: {'accuracy': 0.7227722772277227, 'f1_macro': 0.7137313831563481, 'f1_weighted': 0.7357034080486791, 'precision_macro': 0.7339285714285715, 'recall_macro': 0.7228043143297381}
[2025-04-07 09:21:16,178][__main__][INFO] - Train Epoch: 20 [0/51 (0%)]	Loss: 0.620930
[2025-04-07 09:21:17,671][__main__][INFO] - Epoch 20: Val Loss: 0.7545, Accuracy: 0.6040, Metrics: {'accuracy': 0.6039603960396039, 'f1_macro': 0.6306269567495711, 'f1_weighted': 0.6369148223974643, 'precision_macro': 0.6658887987012987, 'recall_macro': 0.6636941448382127}
[2025-04-07 09:21:17,701][__main__][INFO] - Train Epoch: 21 [0/51 (0%)]	Loss: 0.382454
[2025-04-07 09:21:19,246][__main__][INFO] - Epoch 21: Val Loss: 0.8856, Accuracy: 0.7426, Metrics: {'accuracy': 0.7425742574257426, 'f1_macro': 0.6665390114379085, 'f1_weighted': 0.7267450090597295, 'precision_macro': 0.702639751552795, 'recall_macro': 0.6490562403697997}
[2025-04-07 09:21:19,275][__main__][INFO] - Train Epoch: 22 [0/51 (0%)]	Loss: 0.099187
[2025-04-07 09:21:20,794][__main__][INFO] - Epoch 22: Val Loss: 0.8016, Accuracy: 0.6436, Metrics: {'accuracy': 0.6435643564356436, 'f1_macro': 0.6568257676902537, 'f1_weighted': 0.6759210300202251, 'precision_macro': 0.7030531609195403, 'recall_macro': 0.6704160246533128}
[2025-04-07 09:21:20,828][__main__][INFO] - Train Epoch: 23 [0/51 (0%)]	Loss: 0.305731
[2025-04-07 09:21:22,410][__main__][INFO] - Epoch 23: Val Loss: 0.8108, Accuracy: 0.7228, Metrics: {'accuracy': 0.7227722772277227, 'f1_macro': 0.6625960061443932, 'f1_weighted': 0.7176925065778467, 'precision_macro': 0.6846153846153846, 'recall_macro': 0.64884437596302}
[2025-04-07 09:21:22,443][__main__][INFO] - Train Epoch: 24 [0/51 (0%)]	Loss: 0.405254
[2025-04-07 09:21:23,899][__main__][INFO] - Epoch 24: Val Loss: 0.7576, Accuracy: 0.6634, Metrics: {'accuracy': 0.6633663366336634, 'f1_macro': 0.6771925712558673, 'f1_weighted': 0.6878944125638702, 'precision_macro': 0.6907899921197793, 'recall_macro': 0.7158705701078583}
[2025-04-07 09:21:23,932][__main__][INFO] - Train Epoch: 25 [0/51 (0%)]	Loss: 0.423378
[2025-04-07 09:21:25,458][__main__][INFO] - Epoch 25: Val Loss: 0.7520, Accuracy: 0.6139, Metrics: {'accuracy': 0.6138613861386139, 'f1_macro': 0.6651010101010101, 'f1_weighted': 0.6487568756875687, 'precision_macro': 0.6951796932742055, 'recall_macro': 0.702946841294299}
[2025-04-07 09:21:25,489][__main__][INFO] - Train Epoch: 26 [0/51 (0%)]	Loss: 0.212025
[2025-04-07 09:21:27,048][__main__][INFO] - Epoch 26: Val Loss: 0.7714, Accuracy: 0.7030, Metrics: {'accuracy': 0.7029702970297029, 'f1_macro': 0.6765750105351875, 'f1_weighted': 0.7124496710100845, 'precision_macro': 0.6728932373669216, 'recall_macro': 0.7060670261941449}
[2025-04-07 09:21:27,052][__main__][INFO] - Early stopping triggered after 26 epochs
[2025-04-07 09:21:27,053][__main__][INFO] - Saving best confusion matrix with accuracy: 0.7822
